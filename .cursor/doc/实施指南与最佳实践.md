# å®æ–½æŒ‡å—ä¸æœ€ä½³å®è·µ

## ğŸš€ å®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µ: åŸºç¡€è®¾æ–½ (Week 1-2)

```bash
# 1. åˆå§‹åŒ–TypeScripté¡¹ç›®
pnpm create vite threejs-editor-v3 --template vue-ts
cd threejs-editor-v3

# 2. å®‰è£…æ ¸å¿ƒä¾èµ–
pnpm add vue@^3.5 vue-router@^4 pinia@^2.2
pnpm add three@^0.179 @tweenjs/tween.js@^18
pnpm add element-plus@^2.8 @element-plus/icons-vue
pnpm add @vueuse/core@^11 mitt@^3

# 3. å®‰è£…å¼€å‘ä¾èµ–
pnpm add -D typescript@^5 vite@^5
pnpm add -D @vitejs/plugin-vue @vitejs/plugin-vue-jsx
pnpm add -D sass unplugin-auto-import unplugin-vue-components
pnpm add -D eslint@^9 prettier@^3 vitest@^2
pnpm add -D @types/three @types/node
```

### ç¬¬äºŒé˜¶æ®µ: æ ¸å¿ƒComposables (Week 3-4)

**ä¼˜å…ˆçº§é¡ºåº:**

1. âœ… useThreeScene (æœ€é«˜ä¼˜å…ˆçº§)
2. âœ… useThreeRenderer
3. âœ… useThreeCamera
4. âœ… useThreeControls
5. âœ… useModelLoader
6. âœ… useDragCore (æ‹–æ‹½æ ¸å¿ƒ)
7. âœ… useRaycast (å°„çº¿æ£€æµ‹)

### ç¬¬ä¸‰é˜¶æ®µ: ç¼–è¾‘å™¨åŠŸèƒ½ (Week 5-8)

**åŠŸèƒ½æ¨¡å—é¡ºåº:**

1. æè´¨ç³»ç»Ÿ â†’ 2. ç¯å…‰ç³»ç»Ÿ â†’ 3. èƒŒæ™¯ç³»ç»Ÿ â†’
2. åŠ¨ç”»ç³»ç»Ÿ â†’ 5. åæœŸæ•ˆæœ â†’ 6. æ‹–æ‹½ç³»ç»Ÿ â†’
3. å‡ ä½•ä½“ç³»ç»Ÿ â†’ 8. æ ‡ç­¾ç³»ç»Ÿ â†’ 9. ç€è‰²å™¨ç³»ç»Ÿ

### ç¬¬å››é˜¶æ®µ: å®Œå–„ä¸ä¼˜åŒ– (Week 9-12)

- Week 9-10: ç»„ä»¶è¿ç§»
- Week 11: æµ‹è¯•ç¼–å†™
- Week 12: æ€§èƒ½ä¼˜åŒ–å’Œæ–‡æ¡£

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. Composable ç¼–å†™è§„èŒƒ

```typescript
/**
 * âœ… æ ‡å‡†Composableæ¨¡æ¿
 */
export function useXxx(config?: XxxConfig) {
  // 1. ä¾èµ–æ³¨å…¥
  const store = useXxxStore();
  const eventBus = useEventBus();

  // 2. å“åº”å¼çŠ¶æ€ (ä½¿ç”¨shallowRefä¼˜åŒ–Three.jså¯¹è±¡)
  const state = shallowRef<THREE.Object3D | null>(null);
  const loading = ref(false);

  // 3. è®¡ç®—å±æ€§
  const isReady = computed(() => state.value !== null);

  // 4. æ–¹æ³•
  const doSomething = () => {
    // å®ç°é€»è¾‘
  };

  // 5. ç”Ÿå‘½å‘¨æœŸ
  onUnmounted(() => {
    // æ¸…ç†èµ„æº
  });

  // 6. è¿”å›API (çŠ¶æ€ä½¿ç”¨readonly)
  return {
    state: readonly(state),
    loading: readonly(loading),
    isReady,
    doSomething,
  };
}
```

### 2. Store ç¼–å†™è§„èŒƒ

```typescript
/**
 * âœ… æ ‡å‡†Setup Storeæ¨¡æ¿
 */
export const useXxxStore = defineStore('xxx', () => {
  // 1. State (Three.jså¯¹è±¡ä½¿ç”¨shallowRef)
  const object = shallowRef<THREE.Object3D | null>(null);
  const config = ref<XxxConfig>({});

  // 2. Getters (ä½¿ç”¨computed)
  const isActive = computed(() => object.value !== null);

  // 3. Actions (æ™®é€šå‡½æ•°)
  function setObject(newObject: THREE.Object3D) {
    object.value = newObject;
  }

  function reset() {
    object.value = null;
    config.value = {};
  }

  // 4. è¿”å›å…¬å¼€API
  return {
    // State
    object,
    config,

    // Getters
    isActive,

    // Actions
    setObject,
    reset,
  };
});
```

### 3. ç»„ä»¶ç¼–å†™è§„èŒƒ

```vue
<!-- âœ… æ ‡å‡†ç»„ä»¶æ¨¡æ¿ -->
<script setup lang="ts">
// 1. ç±»å‹å¯¼å…¥
import type { PropType } from 'vue';

// 2. æ¥å£å®šä¹‰
interface Props {
  title: string;
  modelUrl?: string;
}

interface Emits {
  (e: 'update', value: any): void;
}

// 3. Propså®šä¹‰
const props = defineProps<Props>();

// 4. Emitså®šä¹‰
const emit = defineEmits<Emits>();

// 5. Composables
const { scene } = useThreeScene();

// 6. å“åº”å¼çŠ¶æ€
const loading = ref(false);

// 7. è®¡ç®—å±æ€§
const isReady = computed(() => !loading.value);

// 8. æ–¹æ³•
const handleUpdate = () => {
  emit('update', {});
};

// 9. ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  // åˆå§‹åŒ–
});
</script>

<template>
  <div class="component">
    <!-- æ¨¡æ¿ -->
  </div>
</template>

<style scoped lang="scss">
.component {
  // æ ·å¼
}
</style>
```

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•ç¤ºä¾‹

```typescript
// tests/unit/composables/useMaterialEditor.spec.ts
import { describe, it, expect, beforeEach } from 'vitest';
import { useMaterialEditor } from '@/composables/editor/material/useMaterialEditor';
import * as THREE from 'three';

describe('useMaterialEditor', () => {
  let material: THREE.MeshStandardMaterial;

  beforeEach(() => {
    material = new THREE.MeshStandardMaterial({ color: 0xff0000 });
  });

  it('åº”è¯¥æ­£ç¡®é€‰æ‹©æè´¨', () => {
    const { selectMaterial, selectedMaterial } = useMaterialEditor();

    selectMaterial(material);

    expect(selectedMaterial.value).toBe(material);
  });

  it('åº”è¯¥æ­£ç¡®æ›´æ–°é¢œè‰²', () => {
    const { selectMaterial, updateColor } = useMaterialEditor();

    selectMaterial(material);
    updateColor(0x00ff00);

    expect(material.color.getHex()).toBe(0x00ff00);
  });
});
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–æ¸…å•

### Three.js æ€§èƒ½ä¼˜åŒ–

- [ ] ä½¿ç”¨shallowRefå­˜å‚¨Three.jså¯¹è±¡
- [ ] å‡ ä½•ä½“å¤ç”¨ï¼ˆInstancedMeshï¼‰
- [ ] æè´¨å¤ç”¨
- [ ] çº¹ç†å‹ç¼©ï¼ˆKTX2ï¼‰
- [ ] å‡ ä½•ä½“åˆå¹¶
- [ ] LODå±‚çº§ç»†èŠ‚
- [ ] è§†é”¥ä½“å‰”é™¤
- [ ] æŒ‰éœ€æ¸²æŸ“

### Vue æ€§èƒ½ä¼˜åŒ–

- [ ] è™šæ‹Ÿæ»šåŠ¨ï¼ˆæ¨¡å‹åˆ—è¡¨ï¼‰
- [ ] æ‡’åŠ è½½è·¯ç”±
- [ ] ç»„ä»¶å¼‚æ­¥åŠ è½½
- [ ] v-memoä¼˜åŒ–åˆ—è¡¨
- [ ] KeepAliveç¼“å­˜
- [ ] è®¡ç®—å±æ€§ä¼˜åŒ–
- [ ] Watchä¼˜åŒ–ï¼ˆdeep: falseï¼‰

---

## ğŸ“ è¿ç§»æ£€æŸ¥æ¸…å•

### ä»£ç è¿ç§»

- [ ] TypeScripté…ç½®å®Œæˆ
- [ ] æ‰€æœ‰ç±»å‹å®šä¹‰å®Œæˆ
- [ ] æ ¸å¿ƒComposableså®ç°
- [ ] Storesè¿ç§»å®Œæˆ
- [ ] ç»„ä»¶è¿ç§»å®Œæˆ
- [ ] å·¥å…·å‡½æ•°è¿ç§»
- [ ] å¸¸é‡é…ç½®è¿ç§»

### æµ‹è¯•è¦†ç›–

- [ ] Composableså•å…ƒæµ‹è¯• (>80%)
- [ ] Storeså•å…ƒæµ‹è¯• (>80%)
- [ ] ç»„ä»¶æµ‹è¯• (>60%)
- [ ] E2Eæµ‹è¯• (æ ¸å¿ƒæµç¨‹)

### æ–‡æ¡£å®Œå–„

- [ ] APIæ–‡æ¡£
- [ ] å¼€å‘æŒ‡å—
- [ ] éƒ¨ç½²æŒ‡å—
- [ ] æ•…éšœæ’æŸ¥

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡         | ç›®æ ‡    | æµ‹é‡æ–¹å¼            |
| ------------ | ------- | ------------------- |
| **ä»£ç è¡Œæ•°** | å‡å°‘20% | wc -l               |
| **ç±»å‹è¦†ç›–** | 100%    | tsc --noEmit        |
| **æµ‹è¯•è¦†ç›–** | >80%    | vitest --coverage   |
| **æ„å»ºæ—¶é—´** | <30s    | vite build          |
| **åŒ…ä½“ç§¯**   | <2MB    | vite build --report |
| **FPS**      | >60     | Chrome DevTools     |

---

## ğŸ“š å‚è€ƒèµ„æº

- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Pinia å®˜æ–¹æ–‡æ¡£](https://pinia.vuejs.org/)
- [Three.js å®˜æ–¹æ–‡æ¡£](https://threejs.org/docs/)
- [VueUse æ–‡æ¡£](https://vueuse.org/)
- [TypeScript æ‰‹å†Œ](https://www.typescriptlang.org/docs/)
